<style>
/* 弹窗样式调整 */
.layui-layer {
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin-top: 0 !important;
}

/* 限制弹窗最大高度 */
.layui-layer-content {
    max-height: 85vh;
    overflow-y: auto;
}

/* 详情容器样式 */
.instruct-detail-container {
    max-height: 80vh;
    overflow-y: auto;
    padding: 20px;
}
</style>

<!-- 指令详情弹窗内容 -->
<div class="instruct-detail-container">
<div class="layui-row layui-col-space15">
    <!-- 指令基本信息 -->
    <div class="layui-col-xs12 layui-col-md8">
        <div class="layui-card">
            <div class="layui-card-header">
                <h3>指令基本信息</h3>
            </div>
            <div class="layui-card-body">
                <table class="layui-table" lay-skin="line">
                    <tbody>
                        <tr>
                            <td width="120">指令名称</td>
                            <td>{$instruct.instruct_name}</td>
                        </tr>
                        <tr>
                            <td>指令编码</td>
                            <td><span class="layui-badge layui-bg-blue">{$instruct.instruct_code}</span></td>
                        </tr>
                        <tr>
                            <td>指令描述</td>
                            <td>{$instruct.instruct_desc|default='暂无描述'}</td>
                        </tr>
                        <tr>
                            <td>所属应用</td>
                            <td>
                                {if $instruct.app}
                                    <span class="layui-badge layui-bg-blue">{$instruct.app.app_name}</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">未设置</span>
                                {/if}
                            </td>
                        </tr>
                        <tr>
                            <td>所属供应商</td>
                            <td>
                                {if $instruct.supplier}
                                    <span class="layui-badge layui-bg-orange">{$instruct.supplier.name}</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">未设置</span>
                                {/if}
                            </td>
                        </tr>
                        <tr>
                            <td>指令状态</td>
                            <td>
                                {if $instruct.status eq 1}
                                    <span class="layui-badge layui-bg-green">启用</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">禁用</span>
                                {/if}
                            </td>
                        </tr>
                        <tr>
                            <td>创建时间</td>
                            <td>{$instruct.create_time|date='Y-m-d H:i:s'}</td>
                        </tr>
                        <tr>
                            <td>更新时间</td>
                            <td>{$instruct.update_time|date='Y-m-d H:i:s'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 指令统计信息 -->
    <div class="layui-col-xs12 layui-col-md4">
        <div class="layui-card">
            <div class="layui-card-header">
                <h3>统计信息</h3>
            </div>
            <div class="layui-card-body">
                <div class="layui-row layui-col-space10">
                    <div class="layui-col-xs12">
                        <div class="layui-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center;">
                            <div class="layui-card-body">
                                <div style="font-size: 24px; font-weight: bold;">{$devices|count}</div>
                                <div>关联设备</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="layui-row layui-col-space15">
    <!-- 指令关联的设备 -->
    <div class="layui-col-xs12">
        <div class="layui-card">
            <div class="layui-card-header">
                <h3>指令关联的设备</h3>
            </div>
            <div class="layui-card-body">
                {if $devices}
                <table class="layui-table" lay-skin="line">
                    <thead>
                        <tr>
                            <th>设备名称</th>
                            <th>设备编号</th>
                            <th>所属应用</th>
                            <th>所属供应商</th>
                            <th>设备状态</th>
                            <th>关联时间</th>
                        </tr>
                    </thead>
                    <tbody>
                        {foreach $devices as $device}
                        <tr>
                            <td>{$device.device.device_name}</td>
                            <td>{$device.device.device_number}</td>
                            <td>
                                {if $device.device.app}
                                    <span class="layui-badge layui-bg-blue">{$device.device.app.app_name}</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">未设置</span>
                                {/if}
                            </td>
                            <td>
                                {if $device.device.supplier}
                                    <span class="layui-badge layui-bg-orange">{$device.device.supplier.name}</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">未设置</span>
                                {/if}
                            </td>
                            <td>
                                {if $device.device.status eq 1}
                                    <span class="layui-badge layui-bg-green">启用</span>
                                {else}
                                    <span class="layui-badge layui-bg-gray">禁用</span>
                                {/if}
                            </td>
                            <td>{$device.create_time|date='Y-m-d H:i'}</td>
                        </tr>
                        {/foreach}
                    </tbody>
                </table>
                {else}
                <div class="layui-empty">
                    <div class="layui-empty-text">该指令暂无关联设备</div>
                </div>
                {/if}
            </div>
        </div>
    </div>
</div>
</div>

